<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta charset="utf-8">
    <title>FIR</title>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="bootstrap.js"></script>
    <script type="text/javascript" src="js/web3/dist/web3.min.js"></script>
    <script type="text/javascript" src="js/web3-config.js"></script>
    <script type="text/javascript" src="./artifacts/fir.js"></script>
    <script>
      //-------------Get Address--------------
async function wallet() {
let defaultAccount=0;

defaultAccount = await web3.eth.getAccounts()
    .then(
        accounts => accounts[0]
        );

const address_data =  Promise.resolve(defaultAccount);
 address_data.then(value => {

  if(value!=undefined)
  {
     console.log(value);
     setCookie("address", value, 365);
     document.getElementById("wallet_address").innerHTML =value;
     
  }
  else{
    console.log("Please Connect to Wallet and Refresh");
    document.getElementById("address").innerHTML = "Please Connect to Wallet and Refresh.";
  }

}).catch(err => {
 
});

}

wallet();
//-------------Get Address--------------
    </script>
    

<!-- ************** Jquery active link styling *******************  -->

    <style media="screen">
/*------------------- LOADER ---------------------*/
.loader {
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #00218d;
  width: 120px;
  height: 120px;
  -webkit-animation: spin 2s linear infinite; /* Safari */
  animation: spin 2s linear infinite;
}

/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/*------------------- LOADER ---------------------*/

      .active{

        border-bottom: 1.5px solid white;
        border-radius: 5%;
      }

      button{
        margin-right: 3.5% !important;
        color: #f7f8f3 !important;
      background-color: #281859 !important;
      }

    </style>


    <script type="application/javascript">
    $(document).ready(function(){
      $('a').click(function(){
        $('a').removeClass("active");
        $(this).addClass("active");
      });

    });

    </script>
    
    
        <script type="text/javascript">
      function yscroll(){
        var image = document.getElementById('image');
        var headr = document.getElementById('topheader');
        var hd = document.querySelector("h1");
        var h = document.getElementById('h');
        var g =document.getElementById('g');
        ypos=window.pageYOffset;
        if (ypos>120) {
          image.style.display="none";
          headr.style.height="85px";
           h.id='g';
        } else if(ypos<=119) {
          image.style.display="block";
          headr.style.height='auto';
          g.id='h';

        }

      }
      window.addEventListener("scroll",yscroll);

    </script>


<!-- ****************** file linking *************************************-->
    <link rel="stylesheet" href="bootstrap.css">
    <link rel="stylesheet" href="lodgestyle.css">
    <link rel="stylesheet" href="fontawesome/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  </head>

  <body>

    <!-- ****************** complete header *************************************-->

<div class="sticky-top">
  <!-- ****************** top header section *************************************-->

<section id="topheader">
      <div class="container">
        <div class="row">
        <header id="headr">
          <div class="col-xs-6 col-sm-3 col-md-2 col-lg-1" >
            <img id="image" src="img/thinksprout.png" alt="" class="" width="110px" height="70px">
              </div>
              <div class="col-xs-6 col-sm-9 col-md-10 col-lg-11">
                <h1 id="h" class="text-center heading text-responsive">F.I.R portal, MCOE police</h1><h5 id="wallet_address" class="text-center heading text-responsive">Loading..!!</h5>
              </div>
              </header>


            </div>

        </div>

</section>

<!-- ****************** navbar section *************************************-->

<section id="nav-bar">

<div class="container-fluid" >
<nav class="navbar navbar-expand-lg ">
  <a class="navbar-brand " href="#"></a>
  <button class="navbar-toggler mr-auto navbar-dark" type="button" data-toggle="collapse" data-target="#navbarNav"  aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class=""><i class="fas fa-bars fa-1x" style="color:#f7f8f3;"></i></span>
  </button>


  <div class="collapse navbar-collapse" id="navbarNav">
    <div class="navbar-nav ml-auto mr-auto">
      <a class="nav-item nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
      <a class="nav-item nav-link" href="reg_police.html">Onboard Police</a>
      <a class="nav-item nav-link active" href="lodge.html">Lodge Complaint</a>
      <a class="nav-item nav-link" href="view.html">View Complaint</a>
      <a class="nav-item nav-link" href="police-kyc.html">Police KYC</a>
    </div>
  </div>
</nav>

</div>
</section>

</div>

<!-- ****************** header completed *************************************-->


<!-- ****************** modal login  *************************************-->

<!-- <div class="modal fade" id="police_reg">

<div class="modal-dialog modal-dialog-centered">
  <div class="modal-content">

    <div class="modal-header">
     
  </div>
      <div class="modal-body">
        <div class="text-center" id="confirm">
        <img src="img/user.png" class="img-circle" style="width:100px; height:100px;" alt="">
        <p>Police Registration</p>
      </div>
      <div class="text-center" id="reject">
        <img src="img/cancel.png" class="img-circle" style="width:100px; height:100px;" alt="">
        <p>Transaction Failed</p>
      </div>
<center>
      <div class="loader" id="preloader"></div>
    </center>
      </div>



  </div>

</div>

</div> -->




<div class="modal fade" id="model_loader">

<div class="modal-dialog modal-dialog-centered">
  <div class="modal-content">

    <div class="modal-header">
     
  </div>
      <div class="modal-body">
        <div class="text-center" id="confirm">
        <img src="img/check.png" class="img-circle" style="width:100px; height:100px;" alt="">
        <p>Transaction Successful</p>
      </div>
      <div class="text-center" id="reject">
        <img src="img/cancel.png" class="img-circle" style="width:100px; height:100px;" alt="">
        <p>Transaction Failed</p>
      </div>
<center>
      <div class="loader" id="preloader"></div>
    </center>
      </div>



  </div>

</div>

</div>



<!-- ****************** modal completed *************************************-->

<div class="container border">

<div class="">
<form class="" action="" method="post">

  <table class="table">

    <colgroup>
    		<col class="one"/>
    		<col class="two"/>
    		<col class="three"/>
    		<col class="four"/>
    	</colgroup>

    <thead>
      <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

        <tr align="left" class="titles h5" height="30">
          <th colspan="4" style="color: #281859;">Register your Complaint</th>
        </tr>
        </div>
    </div>
        <!--  ********************************* row 1 validation ********************************************-->

        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

        <tr>

         <td colspan="4" align="left" style="color: #281859;padding:2% 1.3%;font-size: 1.25em;font-weight: normal;">
        <font style="margin-bottom:2%;" color="red">Please fill in the form below to register a new complain</font><br>
        <b>Note:</b> Parameters marked with a <font color="red">*</font> are mandatory

       </td>


        </td>
        </tr>
      </div>
      </div>


    </thead>

    <tbody>

      <!--  ********************************* row 1 District name********************************************-->
    <div class="row">
    <tr>
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

      <td colspan="1">
        <label for="FirstComplainantName">First Name of Complainant
          <font color="RED">*</font>

        </label>
      </td>
    </div>
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

      <td colspan="1"><input placeholder="  Name" style=""  type="text" name="FirstComplainantName" id="FirstComplainantName" style="padding:6px;  border:1px solid #281859;" maxlength="50" value="" class="" onchange="" onblur=""></td>
    </div>
    </tr>
  </div>


    <!--  ********************************* row 2 ********************************************-->
    <div class="row">
    <tr>
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

      <td colspan="1">
        <label for="MiddleComplainantName">Middle Name of Complainant
          <font color="RED">*</font>

        </label>
        </td>
      </div>
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

        <td colspan="1"><input placeholder="  Middle name"style="" type="text" name="MiddleComplainantName" id="MiddleComplainantName" style="padding:6px;  border:1px solid #281859;" maxlength="50" value="" class="" onchange="" onblur=""></td>
      </div>
      </tr>
    </div>
    <!--  ********************************* row 3  ********************************************-->

    <div class="row">
    <tr>
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

      <td colspan="1">
        <label for="LastComplainantName">Last Name of Complainant
          <font color="RED">*</font>

        </label>
        </td>
      </div>
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

        <td colspan="1"><input placeholder="  Surname"style="" type="text" name="LastComplainantName" id="LastComplainantName" style="padding:6px;  border:1px solid #281859;" maxlength="50" value="" class="" onchange="" onblur=""></td>

      </div>
      </tr>
    </div>

    <!--  ********************************* new row 4  col 1 gender name********************************************-->


<div class="row">
<tr>

    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

    <td colspan="1">
      <label for="gender">Gender
        <font color="RED">*</font>
        </label>
    </td>

      <!--  ********************************* row 4 col 2 input gender********************************************-->

      <td colspan="1" style="">
<fieldset>

    <label for=""><input id="gender" style="width:auto !important;  padding:0 !important;" type="radio" name="gender" value="male"/> Male</label>  <br>
    <label  for=""><input id="gender" style="width:auto !important; padding:0 !important;" type="radio" name="gender" value="female"/> Female </label> <br>
  </fieldset>

    </td>

    </div>

    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

    <td colspan="1">
      <label for="age">Age
        <font color="RED">*</font>
        </label>
    </td>

      <!--  ********************************* row 4 col 4 input gender********************************************-->

      <td colspan="1">
<input type="number" id="age" placeholder=" Age" min="18" Max="99" name="age" style="width: 50% !important;" value="">
    </td>

    </div>

  </tr>

</div>



    <!--  ********************************* new row 5  col1 address label********************************************-->


<div class="row">
<tr>

    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
    <address class="">

    <td colspan="1">
      <label for="address">Contact Address
        <font color="RED">*</font>
        </label>
    </td>

      <!--  ********************************* row 5 col 2 input gender********************************************-->

      <td colspan="1">

        <textarea id="contact_address" name="address" rows="4" cols="" placeholder="Residential Address" style=""></textarea>
      </td>
  </address>

    </div>

   
  </tr>

</div>




    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

    <td colspan="1">
      <label for="phone">Contact Number
        <font color="RED">*</font>
        </label>
    </td>

      <!--  ********************************* row 6 col 2 input gender********************************************-->

      <td colspan="1">

        <input id="contact_number" type="text" name="phone" value="" maxlength="10" style="" placeholder="Phone Number">
      </td>

    </div>


  </tr>

</div>





<div id="" class="row">

      <tr >

        <!--  ********************************* row 8 col 1  District name********************************************-->
<!--  ********************************* row 8 col 3 police station name********************************************-->

<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
<td colspan="1">
  <label for="PoStationName">Place of Occurence Police Station
    <font color="RED">*</font>
    </label>
</td>



  <!--  ********************************* row 8 col 4 input police station name********************************************-->

  <td colspan="1">
      <select id="stn_id" style="" size="1" name="PoStationName" type="select-one">

  <option value="Pune">Pune</option></select>
  </td>

</div>
    </tr>




  </div>




    <tr>

        <!--  ********************************* row 10 col 1 ********************************************-->
        <td colspan="1" class=""><label for="place">Subject of Complaint
          <font color="RED">*</font>

          </label>
          </td>
          <!--  ********************************* row 10 col 2 ********************************************-->


        <td colspan="1">
          <input id="incedent_related_to" type="text" name="subject" style="" maxlength="150" value="" class="" onchange="" onblur="" placeholder="Enter the type/matter of Complaint"></td>

        </tr>


      <tr>

          <!--  ********************************* row 11 col 1 ********************************************-->
          <td colspan="1" class=""><label for="place">Complaint Detail
            <font color="RED">*</font>

            </label>
            </td>
            <!--  ********************************* row 11 col 2 ********************************************-->


          <td colspan="1">
            <textarea id="details" class="form-control" rows="6" cols="" style="width:175%; padding:6px;border:1px solid #281859;" placeholder="Enter the Details of Complaint."></textarea>

    </tr>

  

    


<!--  ********************************* row 7 ********************************************-->

<tr>
<td colspan="4" align="center">
  <button type="button" onclick="submit_fir()" name="button" data-target="#model_loader" data-toggle="modal">Submit Report</button>
  <button type="reset" value="Reset" name="button">Reset</button></td>
 
</tr>





        </tbody>

  </table>
  
  <h7 id="ref_id" class="text-center heading text-responsive"></h7>
</form>
</div>

</div>











<footer>
  <div class="container-fluid">


<section id="foot">
<div class="row">
<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

<p class="text-center"> <br> &copyCOPYRIGHT 2022 THINKSPROUT VENTURES LLP - ALL RIGHTS RESERVED <br></p>
</div>

</div>
</section>

</div>
</footer>

<script>
  
async function submit_fir()
{

  const fir = new web3.eth.Contract(firAbi, firAddress);



  var _address = getCookie("address");

  var reject = document.getElementById("reject");
   var confirm = document.getElementById("confirm");
   var preloader = document.getElementById("preloader");
   confirm.style.display = "none";
   reject.style.display = "none";


   var FirstComplainantName = document.getElementById("FirstComplainantName").value;
   var MiddleComplainantName = document.getElementById("MiddleComplainantName").value;
   var LastComplainantName = document.getElementById("LastComplainantName").value;
   var gender = document.getElementById("gender").value;
   var age = document.getElementById("age").value;
   var contact_address = document.getElementById("contact_address").value;
   var contact_number = document.getElementById("contact_number").value;
   var station_allot = document.getElementById("stn_id").value;
   var incedent_related_to = document.getElementById("incedent_related_to").value;
   var fir_details = document.getElementById("details").value;

   var name_of_user = FirstComplainantName+" "+MiddleComplainantName+" "+LastComplainantName;

   const options = {
        from: _address,
    };

    fir
        .methods.createFIR(station_allot, name_of_user, gender, age, contact_number, contact_address, incedent_related_to, fir_details).send(options)
        .on("receipt",
            function (receipt) {
                
            
               
                preloader.style.display = "none";
                confirm.style.display = "block";
              
                
                //window.location.reload();
            })
            .on("error",
                    function (error, receipt) {
                        console.log(error);
                        preloader.style.display = "none";
                        reject.style.display = "block";
                       // window.location.reload();
                        console.log(error);
                    }
            ).then(console.log("Transaction-Capture"));
   
            fir.events.id(function(err, data) {
                  if (!err)
                  document.getElementById("ref_id").innerHTML = "Refrence ID: "+data.returnValues[0];
                  console.log(data.returnValues[0]);
                });

              
}
</script>

  </body>
</html>
